<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8"/>
    <title>JSON: Task 1</title>
    <style>
        p {
            color: purple;
            margin: 0.5em 0;
        }
        * {
            box-sizing: border-box;
        }
    </style>
    <link rel="stylesheet" href="../styles.css" />
</head>
<body>
    <section class="preview"></section>
    <script>
        const section = document.querySelector('section');
        let para1 = document.createElement('p');
        let para2 = document.createElement('p');
        let motherInfo = 'The mother cats are called ';
        let kittenInfo;
        const requestURL = 'https://mdn.github.io/learning-area/javascript/oojs/tasks/json/sample.json';

        fetch(requestURL)
            .then(response => response.text())
            .then(text => displayCatInfo(text))

        function displayCatInfo(catString) {
            const cats = JSON.parse(catString);
            let totalKittens = 0;
            let maleKittens = 0;
            let femaleKittens = 0;

            cats.forEach((cat, index) => {
                if (index === cats.length - 1) {
                    motherInfo += `and ${cat.name}.`;
                } else {
                    motherInfo += `${cat.name}, `;
                }
                cat.kittens.forEach(kitten => {
                    totalKittens++;
                    if (kitten.gender === "m") {
                        maleKittens++;
                    } else {
                        femaleKittens++;
                    }
                });
            });

            kittenInfo = `There are ${totalKittens} kittens, ${maleKittens} of them are male and ${femaleKittens} of them are female.`;

            para1.textContent = motherInfo;
            para2.textContent = kittenInfo;
            section.appendChild(para1);
            section.appendChild(para2);
        }
    </script>
</body>
</html>
